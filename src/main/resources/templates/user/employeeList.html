<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<body>
<div class="page-inner" layout:fragment="content">
    <h2>직원 관리</h2>
    <!-- 검색 영역 -->
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <form th:action="@{/employee}" method="get" style="flex-grow: 1; display: flex;">
            <input type="text" name="keyword" placeholder="사원번호 또는 이름 검색" style="flex-grow: 1; margin-right: 10px; padding: 8px;" />
            <button type="submit" style="padding: 8px 16px;">검색</button>
        </form>
    </div>

    <!-- 테이블 영역 -->
    <form th:action="@{/employee/delete}" method="post">
        <table class="table" style="width: 100%; border-collapse: collapse;">
            <thead>
            <tr>
                <th><input type="checkbox" onclick="toggleSelectAll(this)" /></th>
                <th>사원 코드</th>
                <th>이름</th>
                <th>권한</th>
                <th>이메일</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="employee : ${employees}">
                <td><input type="checkbox" name="employeeCodes" th:value="${employee.employeeCode}" /></td>
                <td th:text="${employee.employeeCode}"></td>
                <td th:text="${employee.name}"></td>
                <td th:text="${employee.role}"></td>
                <td th:text="${employee.email}"></td>
            </tr>
            </tbody>
        </table>

        <!-- 버튼 영역 -->
        <div style="display: flex; justify-content: center; margin-top: 20px;">
            <button type="submit" class="btn btn-danger" style="margin-right: 10px; padding: 10px 20px;">선택 삭제</button>
            <div>
                <form th:action="@{/employee/updateRoles}" method="post" style="display: flex; align-items: center;">
                    <label for="newRole" style="margin-right: 10px;">새 권한:</label>
                    <select id="newRole" name="newRole" style="margin-right: 10px; padding: 8px;">
                        <option value="root">root</option>
                        <option value="general">general</option>
                    </select>
                    <button type="submit" class="btn btn-primary" style="padding: 10px 20px;">선택 권한 변경</button>
                </form>
            </div>
        </div>
    </form>
</div>

<script>
    function toggleSelectAll(checkbox) {
        const checkboxes = document.querySelectorAll('input[name="employeeCodes"]');
        checkboxes.forEach(cb => cb.checked = checkbox.checked);
    }
</script>
</body>
</html>