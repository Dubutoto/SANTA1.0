<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.santa.user.mapper.EmployeeMapper">

  <!-- 직원 리스트 조회 -->
  <select id="getAllEmployees" resultType="com.example.santa.user.vo.EmployeeVO">
    SELECT employee_code AS employeeCode,
           name,
           role,
           email
    FROM Administrators
  </select>

  <!-- 직원 검색 -->
  <select id="searchEmployees" resultType="com.example.santa.user.vo.EmployeeVO">
    SELECT employee_code AS employeeCode,
           name,
           role,
           email
    FROM Administrators
    WHERE employee_code LIKE CONCAT('%', #{keyword}, '%')
       OR name LIKE CONCAT('%', #{keyword}, '%')
  </select>

  <!-- 직원 권한 변경 (다중) -->
  <update id="updateEmployeeRoles">
    UPDATE Administrators
    SET role = #{newRole}
    WHERE employee_code IN
    <foreach collection="employeeCodes" item="code" open="(" separator="," close=")">
      #{code}
    </foreach>
  </update>

  <!-- 직원 삭제 (다중) -->
  <delete id="deleteEmployees">
    DELETE FROM Administrators
    WHERE employee_code IN
    <foreach collection="employeeCodes" item="code" open="(" separator="," close=")">
      #{code}
    </foreach>
  </delete>

</mapper>
